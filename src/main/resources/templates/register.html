<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>GraFit - Registro de Usuario</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
    <link th:href="@{/css/register.css}" rel="stylesheet">
</head>

<body>
    <div class="content">
        <!-- Icono de volver al index -->
        <a href="/" class="position-absolute top-0 start-0 m-3 fs-3 back-button">
            <i class="bi bi-arrow-left-square-fill"></i>
        </a>

        <div class="container my-4">
            <div class="row justify-content-center">
                <div class="col-md-8 col-lg-7">
                    <div class="auth-card">
                        <div class="auth-header">
                            <i class="bi bi-person-plus-fill auth-icon"></i>
                            <h2 class="mb-0">Regístrate en GraFit</h2>
                        </div>
                        
                        <div class="auth-body">
                            <!-- Mensaje de error general -->
                            <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
                                <i class="bi bi-exclamation-triangle-fill me-2"></i>
                                <span th:text="${error}">Error message</span>
                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                            </div>

                            <form th:action="@{/register}" th:object="${userDTO}" method="post" class="needs-validation" novalidate>
                                <!-- Datos personales -->
                                <div class="section-divider">
                                    <i class="bi bi-person-badge me-2"></i>Datos personales
                                </div>

                                <div class="row mb-3">
                                    <div class="col-md-4">
                                        <!-- Nombre -->
                                        <div class="mb-3">
                                            <label for="name" class="form-label">Nombre *</label>
                                            <div class="input-group">
                                                <span class="input-group-text"><i class="bi bi-person-fill"></i></span>
                                                <input type="text" th:field="*{name}" class="form-control" th:class="${#fields.hasErrors('name')} ? 'form-control is-invalid' : 'form-control'" id="name" placeholder="Tu nombre" required />
                                                <div class="invalid-feedback" th:if="${#fields.hasErrors('name')}" th:errors="*{name}">Error en nombre</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <!-- Primer apellido -->
                                        <div class="mb-3">
                                            <label for="surname1" class="form-label">Primer apellido *</label>
                                            <input type="text" th:field="*{surname1}" class="form-control" th:class="${#fields.hasErrors('surname1')} ? 'form-control is-invalid' : 'form-control'" id="surname1" placeholder="Primer apellido" required />
                                            <div class="invalid-feedback" th:if="${#fields.hasErrors('surname1')}" th:errors="*{surname1}">Error en primer apellido</div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <!-- Segundo apellido -->
                                        <div class="mb-3">
                                            <label for="surname2" class="form-label">Segundo apellido</label>
                                            <input type="text" th:field="*{surname2}" class="form-control" id="surname2" placeholder="Segundo apellido" />
                                        </div>
                                    </div>
                                </div>

                                <!-- Datos de cuenta -->
                                <div class="section-divider">
                                    <i class="bi bi-shield-lock me-2"></i>Datos de cuenta
                                </div>

                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <!-- Usuario -->
                                        <div class="mb-3">
                                            <label for="username" class="form-label">Nombre de Usuario *</label>
                                            <div class="input-group">
                                                <span class="input-group-text"><i class="bi bi-at"></i></span>
                                                <input type="text" th:field="*{username}" class="form-control" th:class="${#fields.hasErrors('username')} ? 'form-control is-invalid' : 'form-control'" id="username" placeholder="Nombre de usuario" required />
                                                <div class="invalid-feedback" th:if="${#fields.hasErrors('username')}" th:errors="*{username}">Error en usuario</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <!-- Email -->
                                        <div class="mb-3">
                                            <label for="email" class="form-label">E-mail *</label>
                                            <div class="input-group">
                                                <span class="input-group-text"><i class="bi bi-envelope-fill"></i></span>
                                                <input type="email" th:field="*{email}" class="form-control" th:class="${#fields.hasErrors('email')} ? 'form-control is-invalid' : 'form-control'" id="email" placeholder="correo@ejemplo.com" required />
                                                <div class="invalid-feedback" th:if="${#fields.hasErrors('email')}" th:errors="*{email}">Error en email</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <!-- Contraseña -->
                                        <div class="mb-3">
                                            <label for="password" class="form-label">Contraseña *</label>
                                            <div class="input-group">
                                                <span class="input-group-text"><i class="bi bi-key-fill"></i></span>
                                                <input type="password" th:field="*{password}" class="form-control" th:class="${#fields.hasErrors('password')} ? 'form-control is-invalid' : 'form-control'" id="password" placeholder="Contraseña" required />
                                                <div class="invalid-feedback" th:if="${#fields.hasErrors('password')}" th:errors="*{password}">Error en contraseña</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <!-- Confirmar Contraseña -->
                                        <div class="mb-3">
                                            <label for="confirmPassword" class="form-label">Confirmar Contraseña *</label>
                                            <div class="input-group">
                                                <span class="input-group-text"><i class="bi bi-check-circle-fill"></i></span>
                                                <input type="password" th:field="*{confirmPassword}" class="form-control" th:class="${#fields.hasErrors('confirmPassword')} ? 'form-control is-invalid' : 'form-control'" id="confirmPassword" placeholder="Repite contraseña" required />
                                                <div class="invalid-feedback" th:if="${#fields.hasErrors('confirmPassword')}" th:errors="*{confirmPassword}">Error en confirmación</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Datos físicos -->
                                <div class="section-divider">
                                    <i class="bi bi-speedometer2 me-2"></i>Datos físicos
                                </div>

                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <!-- Teléfono -->
                                        <div class="mb-3">
                                            <label for="phone" class="form-label">Teléfono</label>
                                            <div class="input-group">
                                                <span class="input-group-text"><i class="bi bi-telephone-fill"></i></span>
                                                <input type="text" th:field="*{phone}" class="form-control" th:class="${#fields.hasErrors('phone')} ? 'form-control is-invalid' : 'form-control'" id="phone" placeholder="ej. 612345678" />
                                                <div class="invalid-feedback" th:if="${#fields.hasErrors('phone')}" th:errors="*{phone}">Error en teléfono</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <!-- Género -->
                                        <div class="mb-3">
                                            <label for="gender" class="form-label">Género *</label>
                                            <select th:field="*{gender}" class="form-select" th:class="${#fields.hasErrors('gender')} ? 'form-select is-invalid' : 'form-select'" id="gender" required>
                                                <option value="" disabled selected>Selecciona género</option>
                                                <option th:value="MASCULINO">Masculino</option>
                                                <option th:value="FEMENINO">Femenino</option>
                                                <option th:value="OTRO">Otro</option>
                                            </select>
                                            <div class="invalid-feedback" th:if="${#fields.hasErrors('gender')}" th:errors="*{gender}">Error en género</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mb-4">
                                    <div class="col-md-3">
                                        <!-- Altura -->
                                        <div class="mb-3">
                                            <label for="height" class="form-label">Altura *</label>
                                            <input type="number" step="0.01" th:field="*{height}" class="form-control" th:class="${#fields.hasErrors('height')} ? 'form-control is-invalid' : 'form-control'" id="height" placeholder="Altura" required />
                                            <div class="invalid-feedback" th:if="${#fields.hasErrors('height')}" th:errors="*{height}">Error en altura</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <!-- Unidad de Altura -->
                                        <div class="mb-3">
                                            <label for="heightUnit" class="form-label">Unidad *</label>
                                            <select th:field="*{heightUnit}" class="form-select" th:class="${#fields.hasErrors('heightUnit')} ? 'form-select is-invalid' : 'form-select'" id="heightUnit" required>
                                                <option value="" disabled selected>Selecciona</option>
                                                <option th:value="METERS">metros (m)</option>
                                                <option th:value="FEET">pies (ft)</option>
                                            </select>
                                            <div class="invalid-feedback" th:if="${#fields.hasErrors('heightUnit')}" th:errors="*{heightUnit}">Error en unidad</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <!-- Peso -->
                                        <div class="mb-3">
                                            <label for="weight" class="form-label">Peso *</label>
                                            <input type="number" step="0.01" th:field="*{weight}" class="form-control" th:class="${#fields.hasErrors('weight')} ? 'form-control is-invalid' : 'form-control'" id="weight" placeholder="Peso" required />
                                            <div class="invalid-feedback" th:if="${#fields.hasErrors('weight')}" th:errors="*{weight}">Error en peso</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <!-- Unidad de Peso -->
                                        <div class="mb-3">
                                            <label for="weightUnit" class="form-label">Unidad *</label>
                                            <select th:field="*{weightUnit}" class="form-select" th:class="${#fields.hasErrors('weightUnit')} ? 'form-select is-invalid' : 'form-select'" id="weightUnit" required>
                                                <option value="" disabled selected>Selecciona</option>
                                                <option th:value="KG">kg</option>
                                                <option th:value="LBS">lbs</option>
                                            </select>
                                            <div class="invalid-feedback" th:if="${#fields.hasErrors('weightUnit')}" th:errors="*{weightUnit}">Error en unidad</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="text-center">
                                    <button type="submit" class="btn btn-auth btn-danger px-5">
                                        <i class="bi bi-person-plus-fill me-2"></i>Crear cuenta
                                    </button>
                                </div>
                            </form>
                        </div>
                        
                        <div class="auth-footer">
                            <span>¿Ya tienes cuenta?</span>
                            <a th:href="@{/login}" class="auth-link ms-2">Inicia sesión</a>
                        </div>
                    </div>
                    
                    <div class="text-center mt-4">
                        <img th:src="@{/images/GraFitLogo_bgBlack.png}" alt="GraFit Logo" style="height: 40px;">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="text-center py-3 text-muted" style="font-size: 0.9rem;">
        &copy; 2025 ProjectGrafit
    </footer>

    <!-- Bootstrap JS y validación -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script th:src="@{/js/register.js}"></script>
</body>

</html>